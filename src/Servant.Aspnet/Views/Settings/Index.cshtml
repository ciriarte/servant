@inherits Nancy.ViewEngines.Razor.NancyRazorViewBase<dynamic>
@{
    Layout = "Shared/_Layout.cshtml";
    ViewBag.ActiveMenuItem = "settings";
}

<h2>Settings</h2>

<div class="clear"></div>

<div class="row">
    <div class="span9">
        <form action="/settings/" method="POST">
    
            <h4 class="margin-top30">General</h4>
    
            <div class="control-group margin-top10">
                <label for="servanturl">Servant URL</label>
                <input type="text" class="input-medium span4" id="servanturl" name="servanturl" value="@Model.Settings.ServantUrl" />
                <p>Example: <code>servant.io</code> or <code>servant.io:440</code>. Default port is 80.
                    <br/><span class="gray">Wildcard binding is currently not supported. Waiting for Nancy 0.13.</span>
                </p>
            </div>

            <div class="control-group margin-top10">
                <label for="debug">Debug mode</label>
                <label class="checkbox" style="text-align: left;">
                    <input type="checkbox" name="debug" id="debug" value="true" @(Model.Settings.Debug == true ? Html.Raw("checked=\"checked\"") : null) />
                    Enabled
                </label>
            </div>

            <div class="control-group margin-top10">
                <label for="username">Username</label>  
                <input type="text" class="input-medium span4" id="username" name="username" value="@Model.Settings.Username" />
            </div>
            
            <div class="control-group margin-top10">
                <label for="password">Password</label>
                <input type="password" class="input-medium span4" id="password" name="password" value="" />
                <p class="gray">Only enter a password if you want to change the current.</p>
            </div>
    
            <div class="margin-top30">
                <input type="submit" class="btn btn-primary" value="Save settings" />
            </div>
        </form>
        
        <div class="clear"></div>
        
        <h4 class="margin-top30">Log parsing</h4>
        <p class="margin-top10">Log parsing is currently <strong>@Html.Raw((bool)Model.Settings.ParseLogs ? "running" : "stopped")</strong>.</p>
        
        @if((bool)Model.Settings.ParseLogs)
        {
            <form method="POST" action="/settings/startlogparsing/">
                <input type="hidden" value="false" name="start"/>
                <input type="submit" class="btn btn-danger" value="Stop parsing"/>      
            </form>
        } else
        {
            <form method="POST" action="/settings/startlogparsing/">
                <input type="hidden" value="true" name="start"/>
                <input type="submit" class="btn btn-success" value="Start parsing"/>
            </form>
        }
    </div>
</div>

@section javascript {
    <script type="text/javascript">
        var originalServantUrl = "@Model.OriginalServantUrl";
        var repost = false;
    </script>
    <script src="/scripts/serveraddresschanger.js"></script>
}